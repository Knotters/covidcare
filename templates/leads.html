{% extends 'index.html' %}
{% load static %}
{% block title %}<title>{{need | capfirst}} Â· {{appname}}</title>{% endblock %}
{% block nav %}
<nav class="w3-row">
    <a href="/needs" class="w3-left w3-padding"><button class="primary"><i class="material-icons">arrow_back</i></button></a>
    <span class="w3-left"><h3>{{need | capfirst}} providers</h3></span>
    <span class="w3-right w3-row w3-padding">
        <a href="{{superdom}}"><button class="secondary"><i class="material-icons">home</i>Knotters</button></a>
        <a href="/volunteer"><button class="accent"><i class="material-icons">volunteer_activism</i>Volunteer</button></a>
    </span>
</nav>
{% endblock %}
{% block content %}
<div class="w3-row sub-accent w3-padding">
    <form>
    {% if state %}
        <input type="hidden" value="{{state}}" name="state">
    {% endif %}
    <input list="states" id="stateselected" placeholder="Choose state"
    {% if state %}
     value="{{state.name}}"
     disabled
     {% else %}
     name="state"
     {% endif %}
      required />
    <datalist id="states">
    {% for state in states %}
    <option value="{{state.name|capfirst}}">
    {% endfor %}
    </datalist>
    {% if state %}
    <input list="districts" name="district" id="districtselected" placeholder="Choose district"
    {% if district %}
    value="{{district.name}}"
    {% endif %}
    required />
    <datalist id="districts">
    {% for district in districts %}
    <option value="{{district.name|capfirst}}">
    {% endfor %}
    </datalist>
    <a href="/needs/{{need.id}}" ><button class="negative" type="button"><i class="material-icons">clear</i>Clear filters</button></a>
    {% endif %}
    <button class="positive" type="submit" onclick="loadproviders()"><i class="material-icons">autorenew</i>Load providers</button>
    </form>
</div>
<div class="w3-row w3-light-grey" style="padding-bottom: 22px;">
    <br/>
    {% for lead in leads %}
    <div class="w3-col w3-quarter w3-padding">
        <div class="pallete primary">
            <h3>{{lead.provider}}</h3>
            <div class="w3-row">
                <button class="sub-accent"><i class="material-icons">call</i><a href="tel:{{lead.contact}}">{{lead.contact}}</a></button><br/>
                <button class="accent"><i class="material-icons">place</i><a target="_blank" rel="noreferrer" href="https://www.google.com/maps/search/{{lead.location}}">{{lead.location}}</a></button><br/>
                <button class="primary"><i class="material-icons">history</i>{{lead.lastverified}}</button><br/>
            </div>
        </div>
    </div>
    {% empty %}
    <center class="w3-padding">
        <i class="w3-jumbo material-icons">error_outline</i>
        <h1>No leads for {{need}} support yet {% if district %} in {{district.name}}, {% endif %}{% if state %} in {{state.name}}{% endif %}.</h1>
        <h4>Please keep checking here, as the community is regularly updating resources.</h4>
        <h5>Meanwhile, please <a class="positive-text" href="/volunteer">volunteer</a> if you are in the state to help others!</h5>
    </center>
    {% endfor %}
</div>
{% endblock %}